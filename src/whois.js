//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
const detailArray = [];
const allFatherLink = [
    "https://www.whois.com/whois/aroma-zone.vn",
"https://www.whois.com/whois/minhtamresortmuine.com",
"https://www.whois.com/whois/paradiseresortmuine.com",
"https://www.whois.com/whois/dungthaoaudio.com",
"https://www.whois.com/whois/thuexedulichtaynguyen.com",
"https://www.whois.com/whois/tikmua.com",
"https://www.whois.com/whois/amourvilla.com",
"https://www.whois.com/whois/htcexpressvn.com",
"https://www.whois.com/whois/bangkeoanhphat.com",
"https://www.whois.com/whois/kiemmua.com",
"https://www.whois.com/whois/magnetcorner.net",
"https://www.whois.com/whois/mrsvui.com",
"https://www.whois.com/whois/dailyxetaicantho.com",
"https://www.whois.com/whois/khogiay.net",
"https://www.whois.com/whois/amthanhcantho.com",
"https://www.whois.com/whois/lamgiayphepbinhduong.com",
"https://www.whois.com/whois/daunhotno1.com",
"https://www.whois.com/whois/maykhuechtantinhdauaz.com",
"https://www.whois.com/whois/batdongsankhoahoc.com",
"https://www.whois.com/whois/samdtldanang.com",
"https://www.whois.com/whois/legiaplastic.com",
"https://www.whois.com/whois/crewkimpink.com",
"https://www.whois.com/whois/digimetabit.com",
"https://www.whois.com/whois/taxicantho65.com",
"https://www.whois.com/whois/yalyvn.com",
"https://www.whois.com/whois/monobells.com",
"https://www.whois.com/whois/bimviet.online",
"https://www.whois.com/whois/codienkhanhlinh.com",
"https://www.whois.com/whois/hanyoungnux.net",
"https://www.whois.com/whois/thinghiemtruonghoc.com",
"https://www.whois.com/whois/bidimark.com",
"https://www.whois.com/whois/cityhotel.vn",
"https://www.whois.com/whois/cungbaythoi.com",
"https://www.whois.com/whois/dienlanhthanhhanh.com",
"https://www.whois.com/whois/hoalanmoclan.com",
"https://www.whois.com/whois/luatkhanhminh.vn",
"https://www.whois.com/whois/kamifoods.vn",
"https://www.whois.com/whois/shopthoitranghanquoc.com",
"https://www.whois.com/whois/trannhuatha.com",
"https://www.whois.com/whois/vaytinchaplaithap.com",
"https://www.whois.com/whois/hpcsmart.com",
"https://www.whois.com/whois/gxthuannghia.com",
"https://www.whois.com/whois/xedapchibang.com",
"https://www.whois.com/whois/binhthang.vn",
"https://www.whois.com/whois/xetaxicantho.com",
"https://www.whois.com/whois/jostoco.vn",
"https://www.whois.com/whois/hanoi-iec.com",
"https://www.whois.com/whois/cuahangdatthanh.com",
"https://www.whois.com/whois/hatdieuthaotran.com",
"https://www.whois.com/whois/conhantaovina.com",
"https://www.whois.com/whois/beluxpaint.com",
"https://www.whois.com/whois/linhviettravel.com",
"https://www.whois.com/whois/kiemtienonline365.com",
"https://www.whois.com/whois/tuonglap.com",
"https://www.whois.com/whois/nuocmamhoahiep.com",
"https://www.whois.com/whois/luutruphuongbac.com",
"https://www.whois.com/whois/gasvan.vn",
"https://www.whois.com/whois/ahkibui.vn",
"https://www.whois.com/whois/cmcsaigon.com",
"https://www.whois.com/whois/luatthienly.com",
"https://www.whois.com/whois/acool.vn",
"https://www.whois.com/whois/itvnonline.com",
"https://www.whois.com/whois/sabena.vn",
"https://www.whois.com/whois/sabenahotel.com",
"https://www.whois.com/whois/codongnat.com",
"https://www.whois.com/whois/kingwatch.vn",
"https://www.whois.com/whois/baotonlanrungvietnam.vn",
"https://www.whois.com/whois/bangtengika.com",
"https://www.whois.com/whois/jachanoi.vn",
"https://www.whois.com/whois/banghenhabat.com",
"https://www.whois.com/whois/alphajsc.net",
"https://www.whois.com/whois/cherryhotelhue.com",
"https://www.whois.com/whois/angiacorp.com",
"https://www.whois.com/whois/bacsigiadinh.com",
"https://www.whois.com/whois/southwestgate.org",
"https://www.whois.com/whois/ald.vn",
"https://www.whois.com/whois/angiadc.com",
"https://www.whois.com/whois/eastwesthardwood.com",
"https://www.whois.com/whois/angiadc.vn",
"https://www.whois.com/whois/hoaiduyen.com",
"https://www.whois.com/whois/hangonline.net",
"https://www.whois.com/whois/efcvietnam.com",
"https://www.whois.com/whois/ast-vn.com",
"https://www.whois.com/whois/insaodo.com",
"https://www.whois.com/whois/anhdaovo.vn",
"https://www.whois.com/whois/laisuat.vn",
"https://www.whois.com/whois/battranggomsucaocap.com",
"https://www.whois.com/whois/casstar.vn",
"https://www.whois.com/whois/gmsmineral.com",
"https://www.whois.com/whois/nhadattaynguyen.net",
"https://www.whois.com/whois/diamondbaygolfvillas.com",
"https://www.whois.com/whois/bangtenhuyhieu.com",
"https://www.whois.com/whois/giathanhco.com",
"https://www.whois.com/whois/ckqvn.com",
"https://www.whois.com/whois/csivietnam.com",
"https://www.whois.com/whois/xetaithacobinhthuan.com",
"https://www.whois.com/whois/rausachlanson.vn",
"https://www.whois.com/whois/hatthocvang.com",
"https://www.whois.com/whois/hoptienlogistics.com",
"https://www.whois.com/whois/cievietnam.vn",
"https://www.whois.com/whois/atabook.com",
"https://www.whois.com/whois/saomay.vn",
"https://www.whois.com/whois/lamhuyhieudeoao.com",
"https://www.whois.com/whois/songbenhai.com",
"https://www.whois.com/whois/hondaotobinhthuan.com",
"https://www.whois.com/whois/gsdp.vn",
"https://www.whois.com/whois/khaosatdodachtb.com",
"https://www.whois.com/whois/inanphunguyen.com",
"https://www.whois.com/whois/aclasswindow.biz",
"https://www.whois.com/whois/effefx.com",
"https://www.whois.com/whois/betongcuongthinhphat.com",
"https://www.whois.com/whois/gastuchau.com",
"https://www.whois.com/whois/thaomocthiennhiendt.com",
"https://www.whois.com/whois/kimdienvn.com",
"https://www.whois.com/whois/damynghehoalu.com",
"https://www.whois.com/whois/hatdieuthaithuong.com",
"https://www.whois.com/whois/isuzuhaiphong.net",
"https://www.whois.com/whois/drcleancare.com",
"https://www.whois.com/whois/huhitech.com",
"https://www.whois.com/whois/viet-car.com",
"https://www.whois.com/whois/dripbagcoffee.vn",
"https://www.whois.com/whois/orient-corp.com",
"https://www.whois.com/whois/vanct.com",
"https://www.whois.com/whois/vietnamlott.net",
"https://www.whois.com/whois/hophan.net",
"https://www.whois.com/whois/binhdinhquangcao.com",
"https://www.whois.com/whois/instantcoffee3in1g9.com",
"https://www.whois.com/whois/binhlan.com",
"https://www.whois.com/whois/chinhphuong.com",
"https://www.whois.com/whois/dicvietnam.vn",
"https://www.whois.com/whois/cambien.com",
"https://www.whois.com/whois/coimeta.com",
"https://www.whois.com/whois/ptcvn.com",
"https://www.whois.com/whois/lagan.vn",
"https://www.whois.com/whois/thodep.com",
"https://www.whois.com/whois/doanluatsuvungtau.com",
"https://www.whois.com/whois/muabandatvinhanhoa.com",
"https://www.whois.com/whois/iddtech.vn",
"https://www.whois.com/whois/ca-precision.com",
"https://www.whois.com/whois/ca-precision.net",
"https://www.whois.com/whois/ncvpro.com",
"https://www.whois.com/whois/ca-precision.vn",
"https://www.whois.com/whois/daitanphatfoods.com",
"https://www.whois.com/whois/jostoco.com",
"https://www.whois.com/whois/cansaoviet.com",
"https://www.whois.com/whois/datphutho.com",
"https://www.whois.com/whois/lnsseafoods.com",
"https://www.whois.com/whois/freshviewlaw.com",
"https://www.whois.com/whois/simibo.org",
"https://www.whois.com/whois/phuongnamdecor.com",
"https://www.whois.com/whois/songnhuacongnghiep.com",
"https://www.whois.com/whois/chothuexecantho.com",
"https://www.whois.com/whois/pazpak.com",
"https://www.whois.com/whois/ketoantoantam.com",
"https://www.whois.com/whois/dplvn.com",
"https://www.whois.com/whois/danhtrahuunghia.com",
"https://www.whois.com/whois/chaovietnam.vn",
"https://www.whois.com/whois/xaydungvanphong.com",
"https://www.whois.com/whois/dichthuatnuocngoai.com",
"https://www.whois.com/whois/nguonlucviet.net",
"https://www.whois.com/whois/goldhotelsg.com",
"https://www.whois.com/whois/bunbukanvietnam.com",
"https://www.whois.com/whois/phuongvycoffee.vn",
"https://www.whois.com/whois/salacons.com",
"https://www.whois.com/whois/ykhoahoangchau.com",
"https://www.whois.com/whois/lasach.vn",
"https://www.whois.com/whois/xeghepdananghue.com",
"https://www.whois.com/whois/haisan468.com",
"https://www.whois.com/whois/konyangstone.com",
"https://www.whois.com/whois/bulonggiacong.com",
"https://www.whois.com/whois/dulichvietnguyen.com",
"https://www.whois.com/whois/nhasaigon247.com",
"https://www.whois.com/whois/ithings.vn",
"https://www.whois.com/whois/h2computer.net",
"https://www.whois.com/whois/hyalualvietnam.vn",
"https://www.whois.com/whois/bulongviet.com",
"https://www.whois.com/whois/nhadathaiphong.city",
"https://www.whois.com/whois/tapdoanbatdongsan.net",
"https://www.whois.com/whois/distriplusasia.com",
"https://www.whois.com/whois/quangvinhmiennam.com",
"https://www.whois.com/whois/mangdengreenhotel.com",
"https://www.whois.com/whois/dienmaytuloiphat.com",
"https://www.whois.com/whois/phongvebaoanh.com",
"https://www.whois.com/whois/cokhidaithanhdat.com",
"https://www.whois.com/whois/investors-jsc.com",
"https://www.whois.com/whois/beonetop1ngucoc.com",
"https://www.whois.com/whois/manh.space",
"https://www.whois.com/whois/cuahangxemayvn.com",
"https://www.whois.com/whois/hstex.vn",
"https://www.whois.com/whois/ngukimvietchau.com",
"https://www.whois.com/whois/diendanctim.net",
"https://www.whois.com/whois/phuongvycoffee.com",
"https://www.whois.com/whois/favad.org",
"https://www.whois.com/whois/havicovn.com",
"https://www.whois.com/whois/haniko.vn",
"https://www.whois.com/whois/thongtintuyengiaogialai.vn",
"https://www.whois.com/whois/amsvn.net",
"https://www.whois.com/whois/khanhhoipharma.vn",
"https://www.whois.com/whois/bangtennhanvien.net",
"https://www.whois.com/whois/dcmotorbikes.com",
"https://www.whois.com/whois/bandocuocdoi.click",
"https://www.whois.com/whois/klp-travelgroup.com",
"https://www.whois.com/whois/truyenthongthanhtam.com",
"https://www.whois.com/whois/baobigiay.vn",
"https://www.whois.com/whois/havicovn.net",
"https://www.whois.com/whois/chuyenviet.vn",
"https://www.whois.com/whois/lienhoaconhoasinh.com",
"https://www.whois.com/whois/congchungviet.vn",
"https://www.whois.com/whois/mrd-mic.com",
"https://www.whois.com/whois/kinhthien.org",
"https://www.whois.com/whois/suprema.vn",
"https://www.whois.com/whois/gothanhthanh.com",
"https://www.whois.com/whois/ademax.vn",
"https://www.whois.com/whois/dewspa999.com",
"https://www.whois.com/whois/kimlongdtpt.com",
"https://www.whois.com/whois/wellnessstylevietnam.com",
"https://www.whois.com/whois/aelvn.com",
"https://www.whois.com/whois/xn--25giay-9e0ca.com",
];
var interval = 5000; // how much time should the delay between two iterations be (in milliseconds)?
var promise = Promise.resolve();
allFatherLink.forEach((element) => {
  promise = promise.then(function () {
    console.log(element);
    const newWindow = window.open(element);
    newWindow.addEventListener("DOMContentLoaded", function (event) {
      // lay thong tin chi tiet tren whois
      const x = newWindow.document.querySelectorAll(".df-row");
      const y = [];
      const title = []
      for (let index = 0; index < x.length; index++) {
          const w = x[index].childNodes[0].innerText;
          const z = x[index].childNodes[1].innerText;
          if (w!=="Name Servers:") {
            title.push(w);
            y.push(z);    
          }
        
      }
      console.log(y);
      console.log(title)

      detailArray.push(y);
      console.log(detailArray)
      window.alert('ok')
      newWindow.close();
    });

    return new Promise(function (resolve) {
      setTimeout(resolve, interval);
    });
  }).catch((error) => {
    console.log(error); 
  })
});
promise.then(function () {
    generateCSV(detailArray) //! xem cho nay
  console.log("Loop finished.");
  console.log(detailArray);

});
function generateCSV(data) {
    console.log(data);
//   var csv = "Link, Tên CTY, Tên Khách, Ngành, Trạng Thái, Số điện thoại,\n";
  var csv = "Domain:, Registrar:, Registered On:, Expires On:, Updated On:, Status:, Name:, Organization:, Street:, City:, Postal Code:, Country:, Phone:, Email:, Name:, Organization:, Street:, City:, Postal Code:, Country:, Phone:, Email:, Name:, Organization:, Street:, City:, Postal Code:, Country:, Phone:, Email:,\n";
  data.forEach(function (row) {
    csv += row.join(",");
    csv += "\n";
  });

  var hiddenElement = document.createElement("a");
  hiddenElement.href = "data:text/csv;charset=utf-8," + encodeURI(csv);
  hiddenElement.target = "_blank";
  hiddenElement.download = "data.csv";
  hiddenElement.click();
}
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^
//! TODO: ^^^^^^^^^^^^^^^^^^^^do it^^^^^^^^^^^^^^^^^^^^^^^^

// // lay thong tin chi tiet tren whois
// const x = document.querySelectorAll(".df-row");
// const y = [];
// for (let index = 0; index < x.length; index++) {
//   const z = x[index].childNodes[1].innerText;
//   y.push(z);
// }
// console.log(y);
